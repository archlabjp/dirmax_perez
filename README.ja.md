# DIRMAX by Richard Perez

## 概要
　[Richard Perez](http://www.asrc.albany.edu/people/faculty/perez/) 氏による直散分離アルゴリズムは頻繁に参照される。そのオリジナルの
FORTRANコードを参照する難易度が高くなっている。現在のFORTRANコンパイラでは直接
コンパイルすることも難しい。そのため、オリジナルのコードに極力忠実ではあるが、最低限の
変更を施しGFORTRANでコンパイルできるようにしたコードを作成した。

## 関数の説明
　関数 DIRMAX は、ディスクビームモデルを使用して、返されるビーム放射照度を計算する。
引数Gは3つの値からなる配列である。値は、前の読み取り値のグローバル放射照度、現在の読み
取り値のグローバル放射照度、次の読み取り値のグローバル放射照度の順である。引数Zは、同じ
形式を使用するが、値はそれぞれの太陽天頂角である。GまたはZの値のいずれかが利用できない
場合、あるいは前または次のGまたはZの値が利用できない場合、または前または次の読み取りが
現在の読み取りから1.5時間以内に行われなかった場合、適切な値または値が-999.0に置き換え
られなければならない。引数TDが欠落している場合も、欠落している引数の代わりに値-999.0が
使用されるべきである。
　現在の全球放射照度(G(2))は、値を持たなければならない。露点温度(TD)がない場合、補正行
列(CM)のインデックスを見つけるためにTDは使用されず、代わりに行列の特別な列が使用される。
前の全球放射照度（G(1)）または太陽天頂角（Z(1)）がある場合と次のグローバル放射照度（G(3)）
または太陽天頂角（Z(3)）が欠落している場合は、Δkt' (dtk1) は補正行列 (CM) へのインデッ
クスを見つけるために使用されず、補正行列の特別な列が使用される。

## ファイル配置

- origin/DIRMAX.F77 オリジナルのFortran77コード
- src/DIRMAX.F90 Gfotranでコンパイル可能に改変したコード
- src/MAIN.F90 サンプルのメイン関数

## 動作方法

```
$ gfortran src/DIRMAX.F90 src/MAIN.F90 -o main
$ ./main
 The beam irradiance B is:    9.0164700151757060
```


*Read this in other languages: [English](README.md), [日本語](README.ja.md).*